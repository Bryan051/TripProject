<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Mypage</title>
<link rel="stylesheet" href="/resources/css/reset.css" type="text/css">

<style type="text/css">
body {
    display: block;
    margin: 8px;
}
.header {
	width: 90vw;
	border-bottom: 1px solid #EEEEEE;
	margin-left: auto;
	margin-right: auto;
	margin-bottom: 5vh;
	font-size: 1.8rem;
	display:grid;
	grid-template-rows: 13vh;
	font-weight:500;
	text-shadow:  -0.1px 0.1px 0 #000, 0.1px 0.1px 0 #000;
}

.header-category {
	display: flex;
	justify-content: center;
	align-items: center;
}
.header-left{
	flex:2;
	display: flex;
	justify-content: center;
	align-items: center;
}
.header-center{
	flex:3;
	display: flex;
	justify-content: center;
	align-items: center;
}
.header-right{
	flex:2;
	display: flex;
	justify-content: center;
	align-items: center;
}

#logimg {
	width: 280px;
	height: 160px;
	padding-right:1vw;
}

#label-left-plan {
	margin: auto;
}

#label-left-course {
	margin: auto;
}

#label-left-community {
	margin: auto;
}

#label-left-chat {
	margin: auto;
}

#label-right-login {
	padding-left: 1vw;
	padding-right: 1vw;
	margin-left: 3vw;
}

#label-right-register {
	margin-left: 3vw;
}

#logo {
	width: 300px;
	height: 200px;
}

.body {
	width: 100%;
	height: 78vh;
	position: relative;
	/* left: 1vw; */
	display: flex;
	flex-direction: column;
}

/*  프로필 */
.profilearea {
	display: flex;
	padding: 1rem;
	margin-left: 20vw;
}

.imagebox {
	width: 15rem;
	height: 15rem;
	border-radius: 70%;
	border: solid;
	border-width: 4px;
	border-color: #B8E9FF;
	overflow: hidden;
	background: white;
	margin-right: 1rem;
}

.profilepic {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.profile {
	text-align: center;
	font-size: 1.8rem;
	display: flex;
	justify-content: center;
	align-items: center;
}

#profilefix {
	font-size: 1.5rem;
	background-color: #BDBDBD;
	border: none;
	border-radius: 0.5rem;
	padding: 0.4rem;
	margin-left: 1rem;
}

/* 일정 3개 */
.status {
	display: flex;
	justify-content: center;
	align-items: center;
}

.user_status {
	width: 12vw;
	text-align: center;
	background-color: #B8E9FF;
	font-size: 1.8rem;
	color: white;
	margin: 5vw;
	margin-top: 2rem;
	margin-bottom: 2rem;
	padding-top: 1rem;
	border-radius: 0.5rem;
	cursor:pointer;
}

.num {
	cursor:pointer;
	text-align: center;
	border: solid;
	border-width: 2px;
	border-color: grey;
	border-top-color: #B8E9FF;
	background-color: white;
	font-size: 1.8rem;
	color: black;
	padding-top: 0.5rem;
	padding-bottom: 1rem;
	border-color: #ECECEC;
	border-bottom-left-radius: 0.5rem;
	border-bottom-right-radius: 0.5rem;
}

/* main */
.mymain_text {
	font-size: 1.8rem;
	margin-top: 2rem;
	font-weight: bold;
	display:flex;
	justify-content:center;
}
.mine{
	display:flex;
	margin-right:36vw;
}
.somebody{
	display:flex;
	margin-right:26vw;
}
.reviewall{
	display:flex;
	margin-right:24vw;
}
.review2{
	display:flex;
	margin-right:16vw;
}

#community{
	margin-right:40vw;
}

.mymain {
	display: flex;
	padding: 5vw;
	padding-top: 1rem;
	flex-direction: column;
	align-items: center;
	justify-content: center;
}
/*  나의 리뷰  */
.mymain2 {
	display: flex;
	padding: 5vw;
	padding-top: 1rem;
	align-items: flex-start;
	justify-content: center;
}

.list-scroll {
	width: 90vw;
	/* height: 35vh; */
	overflow: auto;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	-ms-overflow-style: none;
}
/* 나의 일정 왼쪽 */
.list-scroll3 {
	width: 45vw;
	/* height: 35vh; */
	overflow: auto;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: flex-end;
	-ms-overflow-style: none;
}
/* 나의 일정 오쪽 */
.list-scroll4 {
	width: 45vw;
	/* height: 35vh; */
	overflow: auto;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: flex-start;
	-ms-overflow-style: none;
}
 /* 나의 리뷰  */
.list-scroll1 {
	width: 30vw;
	height: 35vh;
	overflow: auto;
	display: flex;
	flex-direction: column;
	/* justify-content: center; */
	align-items: center;
	-ms-overflow-style: none;
}
.list-scroll2 {
	width: 30vw;
	height: 35vh;
	overflow: auto;
	display: flex;
	flex-direction: column;
	/* justify-content: center; */
	align-items: center;
	-ms-overflow-style: none;
}


.list-scroll::-webkit-scrollbar {
	display: none;
}
.list-scroll1::-webkit-scrollbar {
	display: none;
}
.list-scroll2::-webkit-scrollbar {
	display: none;
}
.list-scroll3::-webkit-scrollbar {
	display: none;
}
.list-scroll4::-webkit-scrollbar {
	display: none;
}

/* 나의 게시물 */
.main {
	display:grid;
	border: solid;
	border-color: #B8E9FF;
	border-radius: 0.5rem;
	border-width: 2px;
	font-size: 1.8rem;
	padding: 1rem;
	margin-top: 2rem;
	height: 8vh;
	box-sizing: content-box;
	width:50vw;
	align-items: center;
}
/* 나의 일정 */

.main3 {
	display:flex;
	border: solid;
	border-color: #B8E9FF;
	border-radius: 0.5rem;
	border-width: 2px;
	font-size: 1.8rem;
	padding: 1rem;
	margin-top: 2rem;
	margin-left:2rem;
	margin-right:2rem;
	box-sizing: content-box;
	width:35vw;
	align-items: center;
	justify-content:center;
	overflow:hidden;
}

/* 나의리뷰 */
.main1 {
	display:flex;
	flex-direction: column;
	border: solid;
	border-color: #B8E9FF;
	border-radius: 0.5rem;
	border-width: 2px;
	font-size: 1.8rem;
	padding: 1rem;
	margin-top: 2rem;
	/* height: 15vh; */
	box-sizing: content-box;
	width:25vw;
	justify-content: center;
	align-items: center;
} 
.main2 {
	display:flex;
	flex-direction: column;
	border: solid;
	border-color: #B8E9FF;
	border-radius: 0.5rem;
	border-width: 2px;
	font-size: 1.8rem;
	padding: 1rem;
	margin-top: 2rem;
	/* height: 15vh; */
	box-sizing: content-box;
	width:25vw;
	justify-content: center;
	align-items: center;
}

.imageloc1 {
	width: 15rem;
	height: 13rem;
	overflow: hidden;
	background: #BDBDBD;
	display: flex;
	justify-content: center;
	align-items: center;
}
/* 나의 일정 왼쪽*/
.myplan3 {
	display: flex;
	justify-content: center;
	align-items: center;
}
/* 나의 일정 오른쪽*/
.myplan4 {
	display: flex;
	justify-content: center;
	align-items: center;
}
/* 나의 게시물 */
.myplan5 {
	display: grid;
	justify-content: center;
	align-items: center;
	grid-template-columns: 40vw 10vw;
	grid-template-rows: auto;
}
/* 나의 리뷰 */
.myplan1 {
	display: flex;
	justify-content: center;
	align-items: center;
}

.loc1 {
	flex: 1 1 auto;
	display: flex;
	justify-content:center;
}

.loc2 {
	flex: 3 1 auto;
}

.tripname {
	margin: 1rem;
}

.tripdate {
	margin: 1rem;
}

.loc3 {
	flex: 1 1 auto;
	display: flex;
	justify-content:center;
}

/* 나의 리뷰, 나의 게시물 안에 내용 왼(이름) 4 오(버튼) 5*/
.loc4 {
	display: flex;
}
#comdate{
	display:flex;
	margin-left:auto;
}
.loc5 {
	display: flex;
	justify-content:flex-end;
}

/*공 수 삭 */
#share1 {
	font-size: 2rem;
	color: #B8E9FF;
	border: solid;
	border-width: 2px;
	border-color: #B8E9FF;
	border-radius: 0.5rem;
	margin: 1rem;
}

#share2 {
	font-size: 2rem;
	color: #B8E9FF;
	border: solid;
	border-width: 2px;
	border-color: #B8E9FF;
	border-radius: 0.5rem;
	margin: 1rem;
}

#fix1 {
	font-size: 2rem;
	color: #78A84E;
	border: solid;
	border-width: 2px;
	border-color: #78A84E;
	border-radius: 0.5rem;
	margin: 1rem;
}

#fix2 {
	font-size: 2rem;
	color: #78A84E;
	border: solid;
	border-width: 2px;
	border-color: #78A84E;
	border-radius: 0.5rem;
	margin: 1rem;
}

#delete1 {
	font-size: 2rem;
	color: #EFA174;
	border: solid;
	border-width: 2px;
	border-color: #EFA174;
	border-radius: 0.5rem;
	margin: 1rem;
}

#delete2 {
	font-size: 2rem;
	color: #EFA174;
	border: solid;
	border-width: 2px;
	border-color: #EFA174;
	border-radius: 0.5rem;
	margin: 1rem;
}
</style>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script th:inline="javascript">
	function myplan() {
		document.getElementById("plan").style.display = "flex";
		document.getElementById("review").style.display = "none"; 
		document.getElementById("community").style.display = "none";
		
		document.getElementById("myplan").style.display = "flex";
		document.getElementById("myreview").style.display = "none"; 
		document.getElementById("mycommunity").style.display = "none";
	}
	function myreview() {
		document.getElementById("plan").style.display = "none";
		document.getElementById("review").style.display = "flex"; 
		document.getElementById("community").style.display = "none";
		
		document.getElementById("myplan").style.display = "none";
		document.getElementById("myreview").style.display = "flex"; 
		document.getElementById("mycommunity").style.display = "none";
		
		
	}
	function mycommunity() {
		document.getElementById("plan").style.display = "none";
		document.getElementById("review").style.display = "none"; 
		document.getElementById("community").style.display = "flex";
		
		document.getElementById("myplan").style.display = "none";
		document.getElementById("myreview").style.display = "none"; 
		document.getElementById("mycommunity").style.display = "block";
	}
	
	// 일정 삭제 
	function plandelete(planName){
	var userID = [[${session.login}]];
	
	
	$.ajax({
		url : "/login/plandelete",
		type : "post",
		data : { userID : userID,
				planName : planName}
		})
			.done(function(result){
				alert(result);
				location.href="/login/usermain"
			})
			.fail(function(jqXHR){
				alert(jqXHR);
			})
	}
	
	function plansavedelete(planName, shareID){
		var userID = [[${session.login}]];
		
		
		$.ajax({
			url : "/login/plansavedelete",
			type : "post",
			data : { userID : userID,
				     shareID : shareID,
					planName : planName}
			})
				.done(function(result){
					alert(result);
					location.href="/login/usermain"
				})
				.fail(function(jqXHR){
					alert(jqXHR);
				})
		}
	// 일정 공유 
	function planshare(planName){
	var userID = [[${session.login}]];
	
	$.ajax({
		url : "/login/planshare",
		type : "post",
		data : { userID : userID,
				planName : planName}
		})
			.done(function(result){
				alert(result);
				location.href="/login/usermain"
			})
			.fail(function(jqXHR){
				alert(jqXHR);
			})
	}
	
	// 리뷰 삭제 
	function reviewdelete(recommandNumber){
	var userID = [[${session.login}]];
	
	
	$.ajax({
		url : "/review/reviewdelete",
		type : "post",
		data : { userID : userID,
				recommandNumber : recommandNumber}
		})
			.done(function(result){
				alert(result);
				location.href="/login/usermain";
			})
			.fail(function(jqXHR){
				alert(jqXHR);
			})
	}
	
	// 게시물 삭제 
	function communitydelete(communityNumber){
	var userID = [[${session.login}]];
	
	
	$.ajax({
		url : "/login/communitydelete",
		type : "post",
		data : { userID : userID,
				communityNumber : communityNumber}
		})
			.done(function(result){
				alert(result);
				location.href="/login/usermain";
			})
			.fail(function(jqXHR){
				alert(jqXHR);
			})
	}
	
	// 프로필 수정시 프롬프트에 비밀번호 값 받아 /logincheck 이
	function passcheck(){
		var userPW = prompt("수정을 위해 비밀번호를 입력해주세요.");
		if (userPW.value == "") {
		    alert("비밀번호를 입력하세요.");
		    return false;
		  };
		
		var userID = [[${session.login}]];
		
		$.ajax({
			url : "/login/userpasscheck",
			type : "post",
			data : { userID : userID,
					userPW : userPW}
			})
				.done(function(result){
					alert(result);
                    if(result == "ID가 일치하지 않습니다."){
                  	  return false;
                    }
                    if(result == "비밀번호가 일치하지 않습니다."){
                  	  return false;
                    }else{
                  	  location.href="/login/userupdateform";  
                    }
				})
				.fail(function(jqXHR){
					alert(jqXHR);
				})
		}
	
	
</script>
</head>
<body>
	<div class="header">
		<div class="header-category">
			<div class="header-left">
				<a href="/plan" id="label-left-plan">일정 만들기</a>
				<a href="/course/recommandcourse" id="label-left-course">코스추천</a>
				<a href="/community/communitymain" id="label-left-community">커뮤니티</a> 
				<a href="/chatting" id="label-left-chat">동행구하기</a>
			</div>
			<div class="header-center">
				<a href="/"><img src="/resources/image/logo.png" alt="" id="logimg"></a>
			</div>
			<!-- 로그인전 --> 
			<div class ="header-right" th:if="${session.login == null}">
				<a href="/login" id="label-right-login">로그인</a> 
				<a href="/login/registerform" id="label-right-login">회원가입</a>
			</div>
				<!-- 로그인 후 -->
			<div class ="header-right" th:if="${session.login != null}" >
				<a href="/login/logout" id="label-right-login">로그아웃</a>
				<a href="/login/usermain" id="label-right-register">마이페이지</a>
			</div> 
		</div>
	</div>
	<div class="body">
		<div class="profilearea">
			<div class="imagebox">
				<img class="profilepic" id="profilepic"
					src="/resources/image/stonepapa.png">
			</div>
			<div class="profile" th:text="${session.login}">
				내 프로필
			</div>
			<div class="profile">
				<button id="profilefix" type="button"
					onclick="return passcheck();">프로필 수정</button>
			</div>
		</div>

		<div class="status">
			<div class="user_status" onclick="myplan();">
				나의 일정
				<div class="num" th:text="${plancount}">일정 끌고오기</div>
			</div>
			<div class="user_status" onclick="myreview();">
				나의 리뷰
				<div class="num" th:text="${recommandcount}">리뷰 끌고오기</div>
			</div>
			<div class="user_status" onclick="mycommunity();">
				나의 게시물
				<div class="num" th:text="${communitycount}">게시물 끌고오기</div>
			</div>
		</div>

		<div class="mymain_text">
			<div id="plan" style="display: flex;"><div class="mine">나의 일정</div><div class="somebody">남의 일정</div></div>
			<div id="review" style="display: none;"><div class="reviewall">나의 모든 리뷰</div><div class="review2">두번 인증 한 장소</div></div>
			<div id="community" style="display: none;">나의 게시물</div>
		</div>
		<!-- 나의 일정 왼쪽 세로 -->
		<div class="mymain2" id="myplan" style="display: flex;">
			<div class="list-scroll3">
				<div class="main3" th:each="userplan : ${plan}">
					<div class="myplan3">
						<div class="loc2">
							<div class="tripname">
								여행이름 &nbsp; <label th:text="${userplan.planName}"></label>
							</div>
							<div class="tripdate">
								여행일자 &nbsp; <label th:text="${userplan.planFirstDate}"></label>
								~ <label th:text="${userplan.planLastDate}"></label>
							</div>
						</div>
						<div class="loc3">
							<button id="share1" th:onclick="planshare([[${userplan.planName}]])">공유</button>
							<button id="delete1" th:onclick="plandelete([[${userplan.planName}]])">삭제</button>
						</div>
					</div>
				</div>
			</div>
			<!-- 나의 일정 오른쪽 세로 -->
			<div class="list-scroll4">
				<div class="main3" th:each="saveplan : ${savePlanList}">
					<div class="myplan4">
						<div class="loc2">
							<div class="tripname">
								여행이름 &nbsp; <label th:text="${saveplan.planName}"></label>
							</div>
							<div class="tripdate">
								여행일자 &nbsp; <label th:text="${saveplan.planFirstDate}"></label>
								~ <label th:text="${saveplan.planLastDate}"></label>
							</div>
						</div>
						<div class="loc3">
							<button id="delete1" th:onclick="plansavedelete([[${saveplan.planName}]], [[${saveplan.shareID}]])">삭제</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 나의 리뷰  -->
		<div class="mymain2" id="myreview" style="display: none;">
			<div class="list-scroll1">
				<div class="main1" th:each="userrecommand : ${recommand}">
					<div class="myplan1">
						<div class="loc4" >
							<div class="tripdate">
								장소 이름 :<label th:text="${userrecommand.placeName}"></label><br>
								리뷰 날짜 :<label th:text="${#dates.format(userrecommand.recommandNowDate, 'yyyy-MM-dd')}"></label>
							</div>
						</div>
						<div class="loc5">
							<button id="delete1" th:onclick="reviewdelete([[${userrecommand.recommandNumber}]])" >삭제</button>
						</div>
					</div>
				</div>
			</div>
			<div class="list-scroll2">	
				<div class="main2" th:each="user2 : ${user2recommand}">
					<div class="myplan1">
						<div class="loc4" >
							<div class="tripdate">
								두번 인증 한 장소 :&nbsp; <label th:text="${user2.placeName}"></label>
							</div>
						</div>
						<!-- <div class="loc3">
							<button id="delete2" th:onclick="reviewdelete([[${user2.recommandNumber}]])" > 삭제</button>
						</div> -->
					</div>
				</div>
			</div>
		</div>
		<!-- 나의 게시물  -->
		<div class="mymain" id="mycommunity" style="display: none;">
			<div class="list-scroll">
				<div class="main" th:each="usercommunity : ${community}">
					<div class="myplan5">
						<!-- <div class="loc1">
							<img id="" src="#">
						</div> -->
						<div class="loc4">

							<div class="tripname" id="comname">
								게시물이름 &nbsp; <label th:text="${usercommunity.communityTitle}"></label>
							</div>
							<div class="tripdate" id="comdate">
								게시일자 &nbsp; <label th:text="${#dates.format(usercommunity.communityDate, 'yyyy-MM-dd')}"></label>
							</div>
						</div>
						<div class="loc5">
							<button id="fix1" th:onclick="|location.href='/community/communityupdateform?communityNumber=${usercommunity.communityNumber}'|">수정</button>
							<button id="delete1" th:onclick="communitydelete([[${usercommunity.communityNumber}]])">삭제</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	


</body>
</html>

